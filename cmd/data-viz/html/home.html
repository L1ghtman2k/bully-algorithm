<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bully Algorithm</title>

  <style>
html, body { margin:0; padding:0; overflow:hidden }
svg { position:fixed; top:0; left:0; height:100%; width:100% }
  </style>

  <script type="text/javascript" src="../js/d3.v3.min.js"></script>
</head>

<body>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1"
         width="100%" height="100%"
         viewBox="0 0 1024 768"
         preserveAspectRatio="xMidYMid meet">
    </svg>
</body>

<script type="text/javascript">
const radius = 100
var dataset = [
    {"id": "0", "fill": "#F7941E", "stroke": "#231F20", "leader": "5"},
    {"id": "1", "fill": "#F7941E", "stroke": "#231F20", "leader": "5"},
    {"id": "2", "fill": "#F7941E", "stroke": "#231F20", "leader": "5"},
    {"id": "3", "fill": "#F7941E", "stroke": "#231F20", "leader": "5"},
    {"id": "4", "fill": "#F7941E", "stroke": "#231F20", "leader": "5"},
    {"id": "5", "fill": "#F7941E", "stroke": "#231F20", "leader": "5"},

];

var svg = d3.select("svg");

svg.selectAll("circle")
    .data(dataset)
    .enter()
    .append("circle")
    .attr("r", radius)
    .attr("cx", function(d) { return radius + (d.id % 3) * (3 * radius); })
    .attr("cy", function(d) {
        return 200 + 200 * Math.floor(d.id / 3) + Math.floor(d.id / 3) * 50;
    })
    .attr("fill", function(d) { return d.fill; })
    .attr("stroke", function(d) { return d.stroke; })
    .attr("stroke-width", 3);

var leader = svg.selectAll("text")
    .data(dataset)
    .enter()
    .append("text")
    .attr("x", function(d) { return radius - 10 + (d.id % 3) * (3 * radius); })
    .attr("y", function(d) { return 215 + 200 * Math.floor(d.id / 3) + Math.floor(d.id / 3) * 50; })
    .text( function (d) {
        return d.leader;
    })
    .attr("font-family", "sans-serif")
    .attr("font-size", "50px")
    .attr("fill", "black");

// var node = svg
//     .data(dataset)
//     .enter()
//     .append("text")
//     .attr("x", function(d) { return radius - 10 + (d.id % 3) * (3 * radius); })
//     .attr("y", function(d) { return 215 + 200 * Math.floor(d.id / 3) + Math.floor(d.id / 3) * 50; })
//     .text( function (d) {
//         console.log("WHAT");
//         return d.id;
//     })
//     .attr("font-family", "sans-serif")
//     .attr("font-size", "50px")
//     .attr("fill", "black");

//   svg.selectAll("circle")
//     .on("click", function(d) {
    // MAKE STOP START
//       d.pulse = !d.pulse;
//       if (d.pulse) {
//         var selected_circles = d3.select(this);
//         pulsate(selected_circles);

//       }
//     });

  svg.selectAll("circle")
    .on("click", function(d) {
      d.pulse = !d.pulse;
      if (d.pulse) {
        var selected_circles = d3.select(this);
        pulsate(selected_circles);

      }
    });

  function pulsate(selection) {
    recursive_transitions();

    function recursive_transitions() {
      if (selection.data()[0].pulse) {
        selection.transition()
            .duration(400)
            .attr("stroke-width", 2)
            .attr("r", radius - radius / 10)
            .ease('sin-in')
            .transition()
            .duration(800)
            .attr('stroke-width', 3)
            .attr("r", radius)
            .ease('bounce-in')
            .each("end", recursive_transitions);
      }
  }}


</script>

</html>